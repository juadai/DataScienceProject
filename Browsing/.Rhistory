data=read.csv("./dataset/joined_understorey_observations.csv")
head(data)
focused_data=data[data$Plot_number %in% c(7,9,10,12),]#only retain data from plots 7,9,10,12
Y0_data=focused_data[focused_data$Year_monitoring==0,]
Y3_data=focused_data[focused_data$Year_monitoring==3,]
Y6_data=focused_data[focused_data$Year_monitoring==6,]
#calculate species richness in each quadrat each year
library(dplyr)
Y0_rich=c()
for (i in c(7,9,10,12))
{for (j in seq(1,32,1))
{dataset=Y0_data[Y0_data$Plot_number==i & Y0_data$Quadrat_number==j,]
count_scientifname <- dataset %>% count(Scientific.Name)
a=nrow(count_scientifname)
Y0_rich=append(Y0_rich,a)
}
}
Y0_rich
Y3_rich=c()
for (i in c(7,9,10,12))
{for (j in seq(1,32,1))
{dataset=Y3_data[Y3_data$Plot_number==i & Y3_data$Quadrat_number==j,]
count_scientifname <- dataset %>% count(Scientific.Name)
a=nrow(count_scientifname)
Y3_rich=append(Y3_rich,a)
}
}
Y3_rich
Y6_rich=c()
for (i in c(7,9,10,12))
{for (j in seq(1,32,1))
{dataset=Y6_data[Y6_data$Plot_number==i & Y6_data$Quadrat_number==j,]
count_scientifname <- dataset %>% count(Scientific.Name)
a=nrow(count_scientifname)
Y6_rich=append(Y6_rich,a)
}
}
Y6_rich
#Calculate changes in species richness
Y03_rich=Y3_rich-Y0_rich
Y03_rich
Y36_rich=Y6_rich-Y3_rich
Y36_rich
Y06_rich=Y6_rich-Y0_rich
Y06_rich
#Extract in gap/ out of gap information
Quadrat_gap={}
for (i in c(7,9,10,12)){
for (j in seq(1,32,1)){
gap=toString(unique(Y0_data[Y0_data$Plot_number==i & Y0_data$Quadrat_number==j,]$Quadrat_gap))
Quadrat_gap=append(Quadrat_gap,gap)
}
}
Quadrat_gap
length(Quadrat_gap)
#Generate a dataframe for the changes in species richness
Time=rep(c('0-3','3-6','0-6'),c(128,128,128))
Plot_number=rep(rep(c(7,9,10,12),c(32,32,32,32)),3)
Treatment=rep(rep(c("Radial","Gap"),c(64,64)),3)
Quadrat_number=rep(seq(1,32,1),12)
Quadrat_fenced=rep(c('False','True'),192)
Quadrat_gap=rep(Quadrat_gap,3)
Richness_change=c(Y03_rich,Y36_rich, Y06_rich)
rich_df=data.frame(Time, Plot_number, Treatment, Quadrat_number, Quadrat_fenced, Quadrat_gap, Richness_change)
write.csv(rich_df,"/Users/tat/Documents/Data Science Sem 3/Project 2/Github/data_generated/richness_calculation.csv", row.names = TRUE)
#Calculate Shannon's diversity index
Shannon <- function (vector) {
# Define corresponding abundance value for each score
Abundance = c(0.5, 3, 7.5, 15, 25, 35, 45, 55, 65, 75, 85) / 100
names(Abundance) = c('0.5', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10')
scores = as.character(vector)
# Vector containing abundance of each species
a = Abundance[scores]
# Vector containing abundance of each species as a proportion of total
p = a/sum(a)
# Apply formula for Shannon's Diversity Index
return(-sum(log(p)*p))
}
Y0_div=c()
for (i in c(7,9,10,12))
{for (j in seq(1,32,1))
{dataset=Y0_data[Y0_data$Plot_number==i & Y0_data$Quadrat_number==j,]
shannon_di=Shannon(dataset$Score)
Y0_div=append(Y0_div,shannon_di)
}
}
Y0_div
Y3_div=c()
for (i in c(7,9,10,12))
{for (j in seq(1,32,1))
{dataset=Y3_data[Y3_data$Plot_number==i & Y3_data$Quadrat_number==j,]
shannon_di=Shannon(dataset$Score)
Y3_div=append(Y3_div,shannon_di)
}
}
Y3_div
Y6_div=c()
for (i in c(7,9,10,12))
{for (j in seq(1,32,1))
{dataset=Y6_data[Y6_data$Plot_number==i & Y6_data$Quadrat_number==j,]
shannon_di=Shannon(dataset$Score)
Y6_div=append(Y6_div, shannon_di)
}
}
Y6_div
# Calculate changes in species diversity
Y03_div=Y3_div-Y0_div
Y03_div
Y36_div=Y6_div-Y3_div
Y36_div
Y06_div=Y6_div-Y0_div
Y06_div
#Generate a dataframe for the changes in species diversity
Diversity_change=c(Y03_div,Y36_div,Y06_div)
div_df=data.frame(Time, Plot_number, Treatment, Quadrat_number, Quadrat_fenced, Quadrat_gap, Diversity_change)
write.csv(div_df,"/Users/tat/Documents/Data Science Sem 3/Project 2/Github/data_generated/ShannonDI_calculation.csv", row.names = TRUE)
div_df = read.csv("./data_generated/ShannonDI_calculation.csv")
head(div_df)
#Year 0 to 3
div_fenced_03=div_df[div_df$Time=="0-3" & div_df$Quadrat_fenced=="True",]
plot(div_fenced_03$Diversity_change, xlab="16 fenced quadrats for each plot: 7, 9, 10, 12", ylab="change in species diversity", main="Change in species diversity from Y0 to Y3 after browsing exclusion", col=factor(div_fenced_03$Treatment))
abline(h=0, lty=2)
legend("bottomright", legend = paste(c("T1","T2")), col=c("black","red"), pch=1)
boxplot(div_fenced_03$Diversity_change~div_fenced_03$Treatment, xlab="Treatment", ylab="Change in species diversity", main="Change in species diversity from Y0 to Y3 after browsing exclusion")
plot(density(div_fenced_03$Diversity_change), main = "Probability density of the change in species diversity from Y0 to Y3", xlab="Change in species diversity")
#Year 3 to 6
div_fenced_36=div_df[div_df$Time=="3-6" & div_df$Quadrat_fenced=="True",]
plot(div_fenced_36$Diversity_change, xlab="16 fenced quadrats for each plot: 7, 9, 10, 12", ylab="change in species diversity", main="Change in species diversity from Y3 to Y6 after browsing exclusion", col=factor(div_fenced_36$Treatment))
abline(h=0, lty=2)
legend("bottomright", legend = paste(c("T1","T2")), col=c("black","red"), pch=1)
boxplot(div_fenced_36$Diversity_change~div_fenced_36$Treatment, xlab="Treatment", ylab="Change in species diversity", main="Change in species diversity from Y3 to Y6 after browsing exclusion")
plot(density(div_fenced_36$Diversity_change), main = "Probability density of the change in species diversity from Y3 to Y6", xlab="Change in species diversity")
#Year 0 to 6
div_fenced_06=div_df[div_df$Time=="0-6" & div_df$Quadrat_fenced=="True",]
plot(div_fenced_06$Diversity_change, xlab="16 fenced quadrats for each plot: 7, 9, 10, 12", ylab="change in species diversity", main="Change in species diversity from Y0 to Y6 after browsing exclusion", col=factor(div_fenced_06$Treatment))
abline(h=0, lty=2)
legend("bottomright", legend = paste(c("T1","T2")), col=c("black","red"), pch=1)
boxplot(div_fenced_06$Diversity_change~div_fenced_06$Treatment, xlab="Treatment", ylab="Change in species diversity", main="Change in species diversity from Y0 to Y6 after browsing exclusion")
plot(density(div_fenced_06$Diversity_change), main = "Probability density of the change in species diversity from Y0 to Y6", xlab="Change in species diversity")
# Linear model
div_03_lm_a=glm(Diversity_change~Treatment+Quadrat_gap, div_fenced_03,family=gaussian)
summary(div_03_lm_a)
par(mfrow = c(2, 2))
plot(div_03_lm_a)
div_03_lm_b=lm(Diversity_change~Quadrat_gap, div_fenced_03)
summary(div_03_lm_b)
anova(div_03_lm_b,div_03_lm_a)
#there's an evidence that Treatment is significant (i.e. gap treatment has more positive impact on species diversity)
#but not sure if the fit is good enough (data has lighter left tail)
# Gamma and Inverse Gaussian GLM
#manipulate data by adding a constant to every y, so that they are all positive
d=min(div_fenced_03$Diversity_change)-0.0001 #-0.0001 so that y is not 0
div_fenced_03$Diversity_change_pos=div_fenced_03$Diversity_change + abs(d)
#visualisation and test if the data is gamma or inverse Gaussian
plot(density(div_fenced_03$Diversity_change_pos))
#Unlikely to be gamma cause it's not positively skewed
gamma.model=fitdist(div_fenced_03$Diversity_change_pos,"gamma",method=c("mle"))
# Gamma and Inverse Gaussian GLM
#manipulate data by adding a constant to every y, so that they are all positive
d=min(div_fenced_03$Diversity_change)-0.0001 #-0.0001 so that y is not 0
div_fenced_03$Diversity_change_pos=div_fenced_03$Diversity_change + abs(d)
#visualisation and test if the data is gamma or inverse Gaussian
plot(density(div_fenced_03$Diversity_change_pos))
#Unlikely to be gamma cause it's not positively skewed
gamma.model=fitdist(div_fenced_03$Diversity_change_pos,"gamma",method=c("mle"))
library(lme4)
div_03_lmm_a=lmer(Diversity_change~Treatment+Quadrat_gap+(1|Plot_number/Quadrat_number), data=div_fenced_03, REML = FALSE)
# Gamma GLM
#manipulate data by adding a constant to every y, so that they are all positive
t=min(div_03_df$Diversity_change)-0.0001 #-0.0001 so that y is not 0
