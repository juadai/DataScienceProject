polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
density=c(0,0,0,10),
border=c(NA,NA,NA,'lightgrey'),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
density=c(0,0,0,10),
border=c(NA,NA,NA,'lightgrey'),
x.intersp=c(2,2,2,0.5),
col= c('black','red','green',NA), bty='n')
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
density=c(0,0,0,10),
border=c(NA,NA,NA,'lightgrey'),
x.intersp=c(2,2,2,0.5),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
density=c(0,0,0,10),
border=c(NA,NA,NA,'lightgrey'),
x.intersp=c(2,2,2,1),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
density=c(0,0,0,10),
border=c(NA,NA,NA,'lightgrey'),
x.intersp=c(1,1,1,-0.5),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
density=c(0,0,0,10),
border=c(NA,NA,NA,'lightgrey'),
x.intersp=c(1,1,1,-0.5),
col= c('black','red','green',NA), bty='n')
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
density=c(0,0,0,10),
border=c(NA,NA,NA,'lightgrey'),
x.intersp=c(1,1,1,-0.5),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
density=c(0,0,0,10),
border=c(NA,NA,NA,'lightgrey'),
fill=c(NA,NA,NA,'lightgrey'),
x.intersp=c(1,1,1,-0.5),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
border=c(NA,NA,NA,'lightgrey'),
fill=c(NA,NA,NA,'lightgrey'),
x.intersp=c(1,1,1,-0.5),
col= c('black','red','green',NA), bty='n')
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
border=c(NA,NA,NA,'lightgrey'),
fill=c(NA,NA,NA,'lightgrey'),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
border=c(NA,NA,NA,'lightgrey'),
fill=c(NA,NA,NA,'lightgrey'),
x.intersp=c(0,0,0,0),
col= c('black','red','green',NA), bty='n')
?x.intersp
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
border=c(NA,NA,NA,'lightgrey'),
fill=c(NA,NA,NA,'lightgrey'),
x.intersp=c(0,0,0,0),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
border=c(NA,NA,NA,'lightgrey'),
fill=c(NA,NA,NA,'lightgrey'),
x.intersp=c(1,1,1,0),
col= c('black','red','green',NA), bty='n')
par(bg="#fffdf3")
treatments = c("Control", "T1: Gap", "T2: Radial", '95% CI')
shades = c("light grey", rgb(255,0,0, 50, maxColorValue = 255), rgb(0,255,0, 50, maxColorValue = 255))
colours = c("black", "red", "green")
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
border=c(NA,NA,NA,'lightgrey'),
fill=c(NA,NA,NA,'lightgrey'),
x.intersp=c(1,1,1,0),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
border=c(NA,NA,NA,'lightgrey'),
fill=c(NA,NA,NA,'lightgrey'),
x.intersp=c(1,1,1,0),
adj=c(0,0,0,5),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
x.intersp=c(1,1,1,0),
adj=c(0,0,0,5),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
col= c('black','red','green',NA), bty='n')
par(bg="#fffdf3")
treatments = c("Control", "T1: Gap", "T2: Radial", '95% CI')
shades = c("light grey", rgb(255,0,0, 50, maxColorValue = 255), rgb(0,255,0, 50, maxColorValue = 255))
colours = c("black", "red", "green")
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
col= c('black','red','green',NA), bty='n')
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: \nTreatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = treatments,
lty=c(1,1,1,NA),
col= c('black','red','green',NA), bty='n')
X_ingap <- data.frame('DBH.year.0'=1:100, 'InGap'=TRUE, 'Plot'=6, 'Treatment'='T2: Radial')
PI_2 <- predictInterval(merMod = mixed2.0, newdata = X_ingap, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
for (t in c("Control", "T1: Gap", "T2: Radial")) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=t)
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(10,80), xlab = "DBH.year.0", ylab = "predicted DBH.year.6")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(1:100, 100:1), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(1:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c("In Gap", t), fill = c("red", "black"))
}
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: \nTreatments vs Control')
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(10,80), xlab = "DBH.year.0", ylab = "predicted DBH.year.6")
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: \nTreatments vs Control')
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main="Tree Size Model: \n'In Gap' vs Control")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
PI_2 <- predictInterval(merMod = mixed2.0, newdata = X_ingap, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
PI_2 <- predictInterval(merMod = mixed2.0, newdata = X_ingap, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
polygon(c(1:100, 100:1), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
X_ingap <- data.frame('DBH.year.0'=30:100, 'InGap'=TRUE, 'Plot'=6, 'Treatment'='T2: Radial')
PI_2 <- predictInterval(merMod = mixed2.0, newdata = X_ingap, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'='Control')
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main="Tree Size Model: \n'In Gap' vs Control")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(1:100, 100:1), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(1:100, exp(PI_2$fit), type = "l", col = "red")
lines(30:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c("In Gap", 'Control'),
lty=c(1,1),
col= c('black','red'), bty='n')
legend("topleft", legend = c("In Gap", 'Control', '95% CI'),
lty=c(1,1,NA),
col= c('black','red','green',NA), bty='n')
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main="Tree Size Model: \n'In Gap' vs Control")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(30:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c("In Gap", 'Control', '95% CI'),
lty=c(1,1,NA),
col= c('black','red','green',NA), bty='n')
X_ingap <- data.frame('DBH.year.0'=30:100, 'InGap'=TRUE, 'Plot'=6, 'Treatment'='T2: Radial (Not in gap)')
PI_2 <- predictInterval(merMod = mixed2.0, newdata = X_ingap, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
X_ingap <- data.frame('DBH.year.0'=30:100, 'InGap'=TRUE, 'Plot'=6, 'Treatment'='T2: Radial')
PI_2 <- predictInterval(merMod = mixed2.0, newdata = X_ingap, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main="Tree Size Model: 'In Gap' vs Control")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(30:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c("In Gap", 'Control', '95% CI'),
lty=c(1,1,NA),
col= c('black','red','green',NA), bty='n')
legend("topleft", legend = c("T2: Radial (In gap)", t), fill = c("red", "black"))
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main="Tree Size Model: 'In Gap' vs Control")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(30:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c("T2: Radial (In gap)", 'Control', '95% CI'),
lty=c(1,1,NA),
col= c('black','red','green',NA), bty='n')
treatments = c("Control", "T1: Gap", "T2: Radial")
shades = c("light grey", rgb(255,0,0, 50, maxColorValue = 255), rgb(0,255,0, 50, maxColorValue = 255))
colours = c("black", "red", "green")
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: \nTreatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = c("Control", "T1: Gap", "T2: Radial (Not in gap)", '95% CI'),
lty=c(1,1,1,NA),
col= c('black','red','green',NA), bty='n')
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = c("Control", "T1: Gap", "T2: Radial (Not in gap)", '95% CI'),
lty=c(1,1,1,NA),
col= c('black','red','green',NA), bty='n')
library(lme4)
library(merTools)
data = read.csv("/Users/nickjolly/Desktop/tfn/DataScienceProject/Tree DBH/dataset/all_plots.csv", stringsAsFactors = FALSE)
DBHdata = data[1:9]
DBHdata = DBHdata[!is.na(DBHdata$DBH.year.6), ]
DBHdata = DBHdata[!is.na(DBHdata$DBH.year.0), ]
DBHdata$Treatment = factor(DBHdata$Treatment)
DBHdata$Large = factor(DBHdata$Large)
DBHdatarm = DBHdata[DBHdata$DBH.year.6/DBHdata$DBH.year.0 < 1.25 & DBHdata$DBH.year.6/DBHdata$DBH.year.0 > 0.9 & DBHdata$DBH.year.0 < 80, ]
DBHdatarm$InGap = (DBHdatarm$Treatment == "T2: Radial" & DBHdatarm$Large == "Yes")
DBHdatarm$InGap = factor(DBHdatarm$InGap)
mixed2.0 = lmer(log(DBH.year.6)~log(DBH.year.0)+Treatment+InGap+log(DBH.year.0):InGap+(1|Plot), data = DBHdatarm)
X_ingap <- data.frame('DBH.year.0'=30:100, 'InGap'=TRUE, 'Plot'=6, 'Treatment'='T2: Radial')
PI_2 <- predictInterval(merMod = mixed2.0, newdata = X_ingap, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'='Control')
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main="Tree Size Model: 'In Gap' vs Control")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(30:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c('Control',"T2: Radial (In gap)", '95% CI'),
lty=c(1,1,NA),
col= c('black','red','green',NA), bty='n')
par(bg="#fffdf3")
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main="Tree Size Model: 'In Gap' vs Control")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(30:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c('Control',"T2: Radial (In gap)", '95% CI'),
lty=c(1,1,NA),
col= c('black','red','green',NA), bty='n')
library(lme4)
library(merTools)
data = read.csv("/Users/nickjolly/Desktop/tfn/DataScienceProject/Tree DBH/dataset/all_plots.csv", stringsAsFactors = FALSE)
DBHdata = data[1:9]
DBHdata = DBHdata[!is.na(DBHdata$DBH.year.6), ]
DBHdata = DBHdata[!is.na(DBHdata$DBH.year.0), ]
DBHdata$Treatment = factor(DBHdata$Treatment)
DBHdata$Large = factor(DBHdata$Large)
DBHdatarm = DBHdata[DBHdata$DBH.year.6/DBHdata$DBH.year.0 < 1.25 & DBHdata$DBH.year.6/DBHdata$DBH.year.0 > 0.9 & DBHdata$DBH.year.0 < 80, ]
DBHdatarm$InGap = (DBHdatarm$Treatment == "T2: Radial" & DBHdatarm$Large == "Yes")
DBHdatarm$InGap = factor(DBHdatarm$InGap)
mixed2.0 = lmer(log(DBH.year.6)~log(DBH.year.0)+Treatment+InGap+log(DBH.year.0):InGap+(1|Plot), data = DBHdatarm)
X_ingap <- data.frame('DBH.year.0'=30:100, 'InGap'=TRUE, 'Plot'=6, 'Treatment'='T2: Radial')
PI_2 <- predictInterval(merMod = mixed2.0, newdata = X_ingap, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'='Control')
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main="Tree Size Model: 'In Gap' vs Control")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(30:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c('Control',"T2: Radial (In gap)", '95% CI'),
lty=c(1,1,NA),
col= c('black','red','green',NA), bty='n')
for (t in c("Control", "T1: Gap", "T2: Radial")) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=t)
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(10,80), xlab = "DBH.year.0", ylab = "predicted DBH.year.6")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(1:100, 100:1), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(1:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c("In Gap", t), fill = c("red", "black"))
}
par(bg="#fffdf3")
treatments = c("Control", "T1: Gap", "T2: Radial")
shades = c("light grey", rgb(255,0,0, 50, maxColorValue = 255), rgb(0,255,0, 50, maxColorValue = 255))
colours = c("black", "red", "green")
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.95, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
legend("topleft", legend = c("Control", "T1: Gap", "T2: Radial (Not in gap)", '95% CI'),
lty=c(1,1,1,NA),
col= c('black','red','green',NA), bty='n')
library(car)
par(bg="#ffffff")
treatments = c("Control", "T1: Gap", "T2: Radial")
shades = c("light grey", rgb(255,0,0, 50, maxColorValue = 255), rgb(0,255,0, 50, maxColorValue = 255))
colours = c("black", "red", "green")
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: Treatments vs Control')
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.8, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.5, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.5, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.2, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.2, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main='Tree Size Model: Treatments vs Control')
for (i in 1:3) {
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'=treatments[i])
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.4, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = shades[i], border = shades[i])
lines(1:100, exp(PI$fit), type = "l", col = colours[i])
}
X_ingap <- data.frame('DBH.year.0'=30:100, 'InGap'=TRUE, 'Plot'=6, 'Treatment'='T2: Radial')
PI_2 <- predictInterval(merMod = mixed2.0, newdata = X_ingap, level = 0.7, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
X <- data.frame('DBH.year.0'=1:100, 'InGap'=FALSE, 'Plot'=6, 'Treatment'='Control')
PI <- predictInterval(merMod = mixed2.0, newdata = X, level = 0.7, n.sims = 1000, stat = "median", type="linear.prediction", include.resid.var = TRUE)
plot(1:100, exp(PI$fit), type='n', xlim=c(20,60), ylim = c(15,60), xlab = "DBH: Year 0", ylab = "Estimated DBH: Year 6",
main="Tree Size Model: 'In Gap' vs Control")
polygon(c(1:100, 100:1), c(exp(PI$upr), rev(exp(PI$lwr))), col = "light grey", border = "light grey")
lines(1:100, exp(PI$fit), type = "l")
polygon(c(30:100, 100:30), c(exp(PI_2$upr), rev(exp(PI_2$lwr))), col = rgb(255,0,0, 50, maxColorValue = 255), border = rgb(255,0,0, 50, maxColorValue = 255))
lines(30:100, exp(PI_2$fit), type = "l", col = "red")
legend("topleft", legend = c('Control',"T2: Radial (In gap)", '95% CI'),
lty=c(1,1,NA),
col= c('black','red','green',NA), bty='n')
# Load data
library(rstudioapi)
library(pROC)
library(lme4)
library(merTools)
library(lmerTest)
setwd(dirname(getActiveDocumentContext()$path))
diversity_df <- read.csv('../dataset/tables/species_divers_quadrats.csv')
diversity_df_plot <- read.csv('../contingency tables/output/diversity/species_divers_plots.csv')
diversity_df_treat <- read.csv('../contingency tables/output/diversity/species_divers_treatments.csv')
# Treatments, Plot numbers, Quadrat numbers, Life forms as factors
diversity_df$Treatment <- factor(diversity_df$Treatment)
diversity_df$Plot.Number <- factor(diversity_df$Plot.Number)
diversity_df$Quadrat.Number <- factor(diversity_df$Quadrat.Number)
# Convert Fenced, Gap columns to boolean
diversity_df$Gap <- diversity_df$Gap=='True'
diversity_df$Fenced <- diversity_df$Fenced=='True'
diversity_df_plot$Gap <- diversity_df_plot$Gap=='True'
diversity_df_plot$Fenced <- diversity_df_plot$Fenced=='True'
# Remove null rows
diversity_df <- na.omit(diversity_df)
diversity_df_plot <- na.omit(diversity_df_plot)
mixed_Y3_01 <- lmer(X3 ~ X0 + Treatment + Gap + Fenced + X0:Gap + Treatment:Gap +
(1 | Plot.Number), data = diversity_df)
summary(mixed_Y3_01)
anova(mixed_Y3_01, diversity_Y3_02)
colnames(diversity_df)
coef(mixed_Y3_01)
plot(mixed_Y3_01)
mixed_Y3_02 <- get_model(step(mixed_Y3_01)
RSS <- sum((diversity_df$X3 - fitted(mixed_Y3_02, diversity_df))^2)
R2 <- 1-RSS/TSS
R2
mixed_Y3_02 <- get_model(step(mixed_Y3_01)
)
RSS <- sum((diversity_df$X3 - fitted(mixed_Y3_02, diversity_df))^2)
TSS <- sum((diversity_df$X3 - mean(diversity_df$X3))^2)
R2 <- 1-RSS/TSS
R2
mixed_Y6_01 <- lmer(X6 ~ X0 + X3 + Treatment + Gap + Fenced + X0:Gap + Treatment:Gap +
(1 | Plot.Number), data = diversity_df)
mixed_Y6_02 <- get_model(step(mixed_Y6_01))
mixed_Y6_01 <- lmer(X6 ~ (X0 + X3 + Treatment + Gap + Fenced)^2 +
(1 | Plot.Number), data = diversity_df)
summary(mixed_Y6_01)
mixed_Y6_02 <- get_model(step(mixed_Y6_01))
summary(mixed_Y6_02)
RSS <- sum((diversity_df$X6 - fitted(mixed_Y6_02, diversity_df))^2)
TSS <- sum((diversity_df$X6 - mean(diversity_df$X6))^2)
R2 <- 1-RSS/TSS
R2
# Load data
library(rstudioapi)
library(pROC)
library(lme4)
library(lmerTest)
# Load data
library(rstudioapi)
library(pROC)
library(lme4)
library(lmerTest)
setwd(dirname(getActiveDocumentContext()$path))
richness_df <- read.csv('../dataset/tables/species_richness_quadrats.csv')
richness_df_plot <- read.csv('../contingency tables/output/richness/species_richness_plots.csv')
# Treatments, Plot numbers, Quadrat numbers, Life forms as factors
richness_df$Treatment <- factor(richness_df$Treatment)
richness_df$Plot.Number <- factor(richness_df$Plot.Number)
richness_df$Quadrat.Number <- factor(richness_df$Quadrat.Number)
# Convert Fenced, Gap columns to boolean
richness_df$Gap <- richness_df$Gap=='True'
richness_df$Fenced <- richness_df$Fenced=='True'
richness_df_plot$Gap <- richness_df_plot$Gap=='True'
richness_df_plot$Fenced <- richness_df_plot$Fenced=='True'
# Remove null rows
richness_df <- na.omit(richness_df)
richness_df_plot <- na.omit(richness_df_plot)
richness_Y3_01 <- glmer(X3 ~ (X0 + Treatment + Gap + Fenced)^2 + (1}Plot.Number),
richness_Y3_01 <- glmer(X3 ~ (X0 + Treatment + Gap + Fenced)^2 + (1|Plot.Number),
family='poisson', data=richness_df)
richness_Y3_02 <- get_model(step(richness_Y3_01))
plot(richness_Y3_01)
summary(richness_Y3_01)
summary(richness_Y3_01)
richness_Y3_02 <- get_model(step(richness_Y3_01))
step(richness_Y3_01)
step(richness_Y3_01)
richness_Y6_01 <- glmer(X6~ (X0 + X3 + Treatment + Gap + Fenced)^2 + (1|Plot.Number),
family='poisson', data=richness_df)
plot(richness_Y6_01)
richness_Y6_02 <- get_model(step(richness_Y6_01))
