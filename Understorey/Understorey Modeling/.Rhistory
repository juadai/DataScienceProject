# both coefficient is not significant in predicting the diversity, the only significant regressor is plot_number
# model using gaussian
model1 = glm(diversity_change_rate ~ Treatment + as.factor(Plot_number) + as.factor(Quadrat_number), family = gaussian, data = df)
summary(model1)
par(mfrow = c(2,2))
plot(model1)
rate.guass.model <- glm(diversity_change_rate ~ 1 , family = gaussian, data = df)
anova(rate.guass.model, model1, test = "F")
# significant in 5% significance level
# model using gaussian
model = glm(abs_diversity ~ Treatment + as.factor(Plot_number) + as.factor(Quadrat_number), family = gaussian, data = df)
model_selected1 <-step(model, scope=~.)
summary(model_selected1)
par(mfrow = c(2,2))
plot(model_selected1)
#The significant variables are the plot number, all other variables are not significant in predicting the diversity
# model using gamma with inverse link function on relative diversity
gamma.model1=fitdist(df$relative_diversity, "gamma")
gamma.model1
gamma.alpha=gamma.model1$estimate[1]
gamma.beta =gamma.model1$estimate[2]
plot(gamma.model1)
n=length(df$relative_diversity)
samp.pct <- (1:n-0.5)/n
qqplot(x=qgamma(samp.pct,gamma.alpha, gamma.beta), y=sort(df$relative_diversity), xlab = 'Theoretical quantiles', ylab = 'Empirical quantiles', main='Q-Q plot gamma')
abline(0,1,col="red")
model2 = glm(relative_diversity~ Treatment + as.factor(Plot_number) + as.factor(Quadrat_number), family = Gamma(), data = df)
summary(model2)
par(mfrow = c(2,2))
plot(model2)
#goodness of fit
qchisq(0.95,10)
library(msme)
P__disp(model2)
# model fit is adequate, reject the null
# model using gamma with inverse link function + on abs_diversity
abs_diversity <- df$abs_diversity + (-min(df$abs_diversity) + 1)
gamma.model2=fitdist(abs_diversity, "gamma")
gamma.model2
gamma.alpha2=gamma.model2$estimate[1]
gamma.beta2 =gamma.model2$estimate[2]
plot(gamma.model2)
n=length(abs_diversity)
samp.pct2 <- (1:n-0.5)/n
qqplot(x=qgamma(samp.pct2,gamma.alpha2, gamma.beta2), y=sort(abs_diversity), xlab = 'Theoretical quantiles', ylab = 'Empirical quantiles', main='Q-Q plot gamma')
abline(0,1,col="red")
model3 = glm(abs_diversity+ (-min(abs_diversity) + 1)~ Treatment + as.factor(Plot_number) + as.factor(Quadrat_number), family = Gamma(), data = df)
summary(model3)
par(mfrow = c(2,2))
plot(model3)
#goodness of fit
qchisq(0.95,10)
library(msme)
P__disp(model3)
# model fit is adequate, reject the null, but the fit is clearly worse than the relative_diversity
# model using gamma with log link function + abs_diversity
model4 = glm(abs_diversity+ (-min(abs_diversity) + 1) ~ Treatment + as.factor(Plot_number) + as.factor(Quadrat_number), family = Gamma(link = "log"), data = df)
summary(model4)
par(mfrow = c(2,2))
plot(model4)
#goodness of fit
qchisq(0.95,10)
library(msme)
P__disp(model4)
# model fit is adequate, reject the null, but the fit is clearly worse than the relative_diversity
# model using gamma with log link function + relative diversity
model5 = glm(relative_diversity~ Treatment + as.factor(Plot_number) + as.factor(Quadrat_number), family = Gamma(link = "inverse"), data = df)
summary(model5)
par(mfrow = c(2,2))
plot(model5)
#goodness of fit
qchisq(0.95,10)
library(msme)
P__disp(model5)
# model fit is adequate, reject the null, fit better than the abs_diversity
read.csv('/Users/nickjolly/Desktop/tfn/DataScienceProject/Understorey/contingency tables/output/spcies_richness_quadrats.csv')
df <- read.csv('/Users/nickjolly/Desktop/tfn/DataScienceProject/Understorey/contingency tables/output/spcies_richness_quadrats.csv')
View(df)
df['Change.0-6'] > 0
df$Change.0.6 > 0
df$Plot.Number <- factor(df$Plot.Number)
df$Response <- factor(df$Change.0.6 > 0)
df$Response <- factor(df$Change.0.6 > 0)
df
df$Response
levels(df$Response) <- 0, 1
levels(df$Response) <- c(0, 1)
df$Response
levels(df$Response)
levels(df$Response) <- c(0, 1)
df$Response <- factor(df$Change.0.6 > 0)
levels(df$Response)
levels(df$Response) <- c(0, 1)
df$Treatment <- factor(df$Treatment)
df$Response <- factor(df$Change.0.6 > 0)
levels(df$Response)
levels(df$Response) <- c(0, 1)
glm(Response ~ . , family='Binomial', data=df)
glm(Response ~ . , family='binomial', data=df)
df$Response <- df$Change.0.6 > 0
df$Response
as.numeric(df$Response)
View(df)
df$Response <- as.numeric(df$Change.0.6 > 0)
glm(Response ~ . , family='binomial', data=df)
str(df)
glm(Response ~ Treatment + Fenced + Gap, family='binomial', data=df)
model1 <- glm(Response ~ Treatment + Fenced + Gap, family='binomial', data=df)
summary(model1)
model1 <- glm(Response ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
summary(model1)
model1 <- glm(Response ~ Treatment + Fenced + Gap, family='binomial', data=df)
summary(model1)
model1 <- glm(Response ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
model2 <- glm(Response ~ Treatment + Fenced + Gap, family='binomial', data=df)
anova(model2, model1)
anova(model2, model1, test='Chi')
anova(model1)
anova(model1, test='Chi')
df$Treatment <- factor(df$Treatment)
View(df)
model1 <- glm(Response ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
summary(model1)
model2 <- glm(Response ~ Treatment + Fenced + Gap, family='binomial', data=df)
summary(model2)
anova(model2, model1, test='Chi')
anova(model1, test='Chi')
summary(model2)
View(df)
new_x <- data.frame('Treatment'='Control', 'Fenced'=FALSE, 'Gap'=TRUE)
predict(model2, new_x)
step(model2)
model3 <- glm(Response ~ Treatment + Gap, data=df)
model3 <- glm(Response ~ Treatment + Gap, data=df)
new_x <- data.frame('Treatment'='Control', 'Fenced'=FALSE, 'Gap'=TRUE)
anova(model2, model1, test='Chi')
anova(model3, model2, test='Chi')
anova(model2, model3, test='Chi')
anova(model3, model2, test='Chi')
summary(model3)
anova(model3, model2, test='Chi')
anova(model2, model3, test='Chi')
anova(model2, model1, test='Chi')
anova(model2, model3, test='Chi')
anova(model3, model2, test='Chi')
summary(model3)
eta_gap <- 0.39273 -0.15471
exp(eta_gap)/(1+exp(eta_gap))
exp(0.39273)/(1+exp(0.39273))
model4 <- glm(Response ~ (Treatment + Gap)^2, data=df)
summary(model4)
step(model4)
plot(model4)
plot(model3)
df[1,]
predict(model3, df[1,])
predict(model3, df[2,])
predict(model3, df[3,])
predict(model3, df[500,])
predict(model3, df[40,])
predict(model3, df[42,])
predict(model3, df[43,])
predict(model3, df[44,])
predict(model3, df[41,])
View(df)
predict(model3, df[139,])
plot(df)
plot(df[c('Treatment', X0)])
plot(df$Treatment, df$X0)
plot(df$Treatment, df$Change.0.6)
plot(df$Treatment, df$Change.0.6)
summary(model3)
model1 <- glm(Response ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
summary(model1)
model2 <- glm(Response ~ Treatment + Fenced + Gap, family='binomial', data=df)
summary(model2)
model3 <- glm(Response ~ Treatment + Gap, family='binomial', data=df)
summary(model3)
?glm
df
str(df)
model10 <- glm(X6 ~ X0 + X3 + Treatment + Fenced + Gap, data=df)
summary_model10
summary(model10)
plot(model10)
model10 <- glm(X6 ~ X0 + X3 + Treatment + Fenced + Gap, data=df)
model11 <- glm(log(X6) ~ log(X0) + log(X3) + Treatment + Fenced + Gap, data=df)
summary(model11)
plot(model11)
summary(model11)
model12 <- glm(log(X6) ~ log(X0) + Treatment + Fenced + Gap, data=df)
summary(model12)
df2 <- read.csv('/Users/nickjolly/Desktop/tfn/DataScienceProject/Understorey/contingency tables/output/spcies_divers_quadrats.csv')
df2
str(df2)
df$Response <- as.numeric(df$Change.0.6>0)
df$Treatment <- factor(df$Treatment)
str(df2)
df2$Response <- as.numeric(df$Change.0.6>0)
df2$Treatment <- factor(df$Treatment)
plot(df2)
plot(df2, pch='.')
model1 <- glm(Response ~ Treatment + Fenced + Gap, data=df2)
summary(model2)
pchisq(356.79, 282)
1-pchisq(356.79, 282)
model1 <- glm(Response ~ Treatment + Fenced + Gap, data=df2)
summary(model1)
y_hat <- predict(model1, df2)
y-y_hat
y <- df$Response
y-y_hat
plot(y-y_hat)
plot(sorted(y_hat))
plot(sort(y_hat))
summary(model1)
step(model1)
model1 <- glm(Response ~ Treatment + Fenced + Gap, family='binomial', data=df2)
summary(model1)
step(model1)
anova(model2, moodel1)
anova(model2, model1)
model2 <- steep(model1)
anova(model2, model1)
model2 <- step(model1)
anova(model2, model1)
anova(model2, model1, test='Chi')
model2 <- step(model1)
y_hat <- predict(model2, df2)
plot(sort(y_hat))
1/(1+exp(-y_hat))
plot(1/(1+exp(-y_hat)))
plot(sort(1/(1+exp(-y_hat))))
?sigmoid
str(df2)
df$X3>df$X0
df2$Response <- as.numeric(df$X3>df$X0)
df2$Treatment <- factor(df$Treatment)
plot(df2, pch='.')
model1 <- glm(Response ~ Treatment + Fenced + Gap, family='binomial', data=df2)
model2 <- step(model1)
df2$Treatment <- factor(df$Treatment)
model1 <- glm(Response ~ Treatment + Fenced + Gap, family='binomial', data=df2)
model2 <- step(model1)
step(model1)
summary(model1)
summary(modle2)
summary(model2)
model1 <- glm(Response ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df2)
model2 <- step(model1)
summary(model2)
model3 <- glm(Response ~ (Treatment + Gap)^2, family='binomial', data=df2)
anova(model3, model2)
anova(model3, model2, test='Chi')
df <- read.csv('/Users/nickjolly/Desktop/tfn/DataScienceProject/Understorey/contingency tables/output/spcies_divers_quadrats.csv')
str(df)
df$Y6 <- as.numeric(df$X6>df$X0)
df$Y3 <- as.numeric(df$X3>df$X0)
df$Treatment <- factor(df$Treatment)
plot(df, pch='.')
model1 <- glm(Response ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
model1 <- glm(Y6 ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
summary(model1)
step(model1)
model2 <- step(model1)
summary(model2)
model3 <- glm(Response ~ (Treatment + Gap)^2, family='binomial', data=df2)
model3 <- glm(Response ~ (Treatment + Gap)^2, family='binomial', data=df)
model3 <- glm(Y3 ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
summary(model3)
model4 <- step(model3)
summary(model4)
summary(model2)
model3 <- glm(Y3 ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
model4 <- step(model3)
summary(model4)
model3 <- glm(Response ~ (Treatment + Gap)^2, family='binomial', data=df)
model1 <- glm(Y6 ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
summary(model1)
model2 <- step(model1)
summary(model2)
model3 <- glm(Y3 ~ (Treatment + Fenced + Gap)^2, family='binomial', data=df)
summary(model3)
model4 <- step(model3)
summary(model4)
summary(model2)
model1 <- glm(X6 ~ (X0 + Treatment + Fenced + Gap)^2, family='binomial', data=df)
summary(model1)
model2 <- step(model1)
model1 <- glm(X6 ~ (X0 + Treatment + Fenced + Gap)^2, family='binomial', data=df)
glm(X6 ~ (X0+Treatment+Fenced+Gap)^2, data=df)
step(glm(X6 ~ (X0+Treatment+Fenced+Gap)^2, data=df))
m1 <- step(glm(X6 ~ (X0+Treatment+Fenced+Gap)^2, data=df))
summary(m1)
plot(m1)
# Load data
richness_df <- read.csv('../dataset/tables/species_richness_quadrats.csv')
install.packages('rstudioapi')
library(rstudioapi)
setwd(dirname(getActiveDocumentContext()$path))
# Load data
richness_df <- read.csv('../dataset/tables/species_richness_quadrats.csv')
diversity_df <- read.csv('../dataset/tables/species_divers_quadrats.csv')
abundance_df <- read.csv('../dataset/tables/lf_abund_analysis.csv')
abundance_rel_df <- read.csv('../dataset/tables/lf_abund_rel_analysis.csv')
# Load data
richness_df <- read.csv('../dataset/tables/species_richness_quadrats.csv')
diversity_df <- read.csv('../dataset/tables/species_divers_quadrats.csv')
abundance_df <- read.csv('../dataset/tables/lf_abund_analysis.csv')
abundance_rel_df <- read.csv('../dataset/tables/lf_abund_rel_analysis.csv')
# Treatments, Plot numbers, Quadrat numbers, Life forms as factors
richness_df$Treatment <- factor(richness_df$Treatment)
diversity_df$Treatment <- factor(diversity_df$Treatment)
abundance_df$Treatment <- factor(abundance_df$Treatment)
abundance_rel_df$Treatment <- factor(abundance_rel_df$Treatment)
richness_df$Plot.Number <- factor(richness_df$Plot.Number)
diversity_df$Plot.Number <- factor(diversity_df$Plot.Number)
abundance_df$Plot.Number <- factor(abundance_df$Plot.Number)
abundance_rel_df$Plot.Number <- factor(abundance_rel_df$Plot.Number)
richness_df$Quadrat.Number <- factor(richness_df$Quadrat.Number)
diversity_df$Quadrat.Number <- factor(diversity_df$Quadrat.Number)
abundance_df$Quadrat.Number <- factor(abundance_df$Quadrat.Number)
abundance_rel_df$Quadrat.Number <- factor(abundance_rel_df$Quadrat.Number)
abundance_df$Life.Form <- factor(abundance_df$Life.Form)
abundance_rel_df$Life.Form <- factor(abundance_rel_df$Life.Form)
# Convert Fenced, Gap columns to boolean
richness_df$Gap <- richness_df$Gap=='True'
diversity_df$Gap <- diversity_df$Gap=='True'
abundance_df$Gap <- abundance_df$Gap=='True'
abundance_rel_df$Gap <- abundance_rel_df$Gap=='True'
richness_df$Fenced <- richness_df$Fenced=='True'
diversity_df$Fenced <- diversity_df$Fenced=='True'
abundance_df$Fenced <- abundance_df$Fenced=='True'
abundance_rel_df$Fenced <- abundance_rel_df$Fenced=='True'
# Relative Abundance: convert from proportion to percentage, round up those below 1%, and round to integer
abundance_rel_df$response <- abundance_rel_df$X0*100
abundance_rel_df[abundance_rel_df$response < 1 & abundance_rel_df$response != 0, 'response'] <- 1
abundance_rel_df$response <- round(abundance_rel_df$response)
# Richness: remove null rows
richness_df <- na.omit(richness_df)
View(diversity_df)
diveresity_df <- na.omit(diversity_df)
diversity_df$Y0.Y3.Increase <- as.numeric(diversity_df$Y0.Y3.Increase)
diversity_df$Y0.Y3.Increase <- diversity_df$X3 > diversity_df$X0
diversity_df$Y0.Y3.Increase <- as.numeric(diversity_df$Y0.Y3.Increase)
View(diveresity_df)
View(diversity_df)
library(rstudioapi)
setwd(dirname(getActiveDocumentContext()$path))
# Load data
richness_df <- read.csv('../dataset/tables/species_richness_quadrats.csv')
diversity_df <- read.csv('../dataset/tables/species_divers_quadrats.csv')
abundance_df <- read.csv('../dataset/tables/lf_abund_analysis.csv')
abundance_rel_df <- read.csv('../dataset/tables/lf_abund_rel_analysis.csv')
# Treatments, Plot numbers, Quadrat numbers, Life forms as factors
richness_df$Treatment <- factor(richness_df$Treatment)
diversity_df$Treatment <- factor(diversity_df$Treatment)
abundance_df$Treatment <- factor(abundance_df$Treatment)
abundance_rel_df$Treatment <- factor(abundance_rel_df$Treatment)
richness_df$Plot.Number <- factor(richness_df$Plot.Number)
diversity_df$Plot.Number <- factor(diversity_df$Plot.Number)
abundance_df$Plot.Number <- factor(abundance_df$Plot.Number)
abundance_rel_df$Plot.Number <- factor(abundance_rel_df$Plot.Number)
richness_df$Quadrat.Number <- factor(richness_df$Quadrat.Number)
diversity_df$Quadrat.Number <- factor(diversity_df$Quadrat.Number)
abundance_df$Quadrat.Number <- factor(abundance_df$Quadrat.Number)
abundance_rel_df$Quadrat.Number <- factor(abundance_rel_df$Quadrat.Number)
abundance_df$Life.Form <- factor(abundance_df$Life.Form)
abundance_rel_df$Life.Form <- factor(abundance_rel_df$Life.Form)
# Convert Fenced, Gap columns to boolean
richness_df$Gap <- richness_df$Gap=='True'
diversity_df$Gap <- diversity_df$Gap=='True'
abundance_df$Gap <- abundance_df$Gap=='True'
abundance_rel_df$Gap <- abundance_rel_df$Gap=='True'
richness_df$Fenced <- richness_df$Fenced=='True'
diversity_df$Fenced <- diversity_df$Fenced=='True'
abundance_df$Fenced <- abundance_df$Fenced=='True'
abundance_rel_df$Fenced <- abundance_rel_df$Fenced=='True'
# Relative Abundance: convert from proportion to percentage, round up those below 1%, and round to integer
abundance_rel_df$response <- abundance_rel_df$X0*100
abundance_rel_df[abundance_rel_df$response < 1 & abundance_rel_df$response != 0, 'response'] <- 1
abundance_rel_df$response <- round(abundance_rel_df$response)
# Richness: remove null rows
richness_df <- na.omit(richness_df)
diversity_df <- na.omit(diversity_df)
diversity_df$Y0.Y3.Increase <- diversity_df$X3 > diversity_df$X0
diversity_df$Y0.Y3.Increase <- as.numeric(diversity_df$Y0.Y3.Increase)
View(diversity_df)
# Model 1:
diversity_Y0_Y3_01 <- glm(Y0.Y3.Increase ~ (Treatment + Fenced + Gap)^2,
family='binomial', data=diversity_df)
summary(diversity_Y0_Y3_01)
# Model 2: Step-wise selection fom Model 1 (AIC)
diversity_Y0_Y3_02 <- step(diversity_Y0_Y3_01)
summary(diversity_Y0_Y3_02)
anova(diversity_Y0_Y3_01, diversity_Y0_Y3_02, test='Chi')
# Model 3: Check a model without interaction terms
diversity_Y0_Y3_03 <- glm(Y0.Y3.Increase ~ Treatment + Fenced + Gap,
family='binomial', data=diversity_df)
summary(diversity_Y0_Y3_03)
# Model 4: Try step-wise selection (BIC)
k = log(length(diversity_df[,1]))
length(diversity_df[,1])
diversity_Y0_Y3_04 <- step(diversity_Y0_Y3_01, k=k)
summary(diversity_Y0_Y3_04)
anova(model2, model4, test='Chi')
anova(diversity_Y0_Y3_02, diversity_Y0_Y3_04, test='Chi')
anova(diversity_Y0_Y3_04, diversity_Y0_Y3_02, test='Chi')
# There is not significant evidence to suggest that Fenced or Gap are significant
summary(diversity_Y0_Y3_02)
# There is not significant evidence to suggest that Fenced or Gap are significant
summary(diversity_Y0_Y3_02)
# Estimated odds that diversity increased in a Gap Treatment (vs Control)
exp(0.04498)
# Estimated odds that diversity increased in a Radial Treatment quadrat (vs Control)
exp(-0.87843)
# Estimated 95% CI for these odds
c(exp(-0.87843-1.96*0.31185), exp(-0.87843+1.96*0.31185))
# Model the probability that diversity increased between years 3 and 6
diversity_df$Y3.Y6.Increase <- diversity_df$X6 > diversity_df$X3
diversity_df$Y3.Y6.Increase <- as.numeric(diversity_df$Y3.Y6.Increase)
# Model 1: Treatment, Fenced, Gap, with first-order interaction terms
diversity_Y3_Y6_01 <- glm(Y3.Y6.Increase ~ (Treatment + Fenced + Gap)^2,
famly='binomial', data=diversity_df)
# Model 1: Treatment, Fenced, Gap, with first-order interaction terms
diversity_Y3_Y6_01 <- glm(Y3.Y6.Increase ~ (Treatment + Fenced + Gap)^2,
family='binomial', data=diversity_df)
summary(diversity_Y3_Y6_01)
# Model 2: Step-wise selection from Model 1 (AIC)
diversity_Y3_Y6_02 <- step(diversity_Y3_Y6_01)
summary(diversity_Y3_Y6_02)
anova(diversity_Y3_Y6_02, diversity_Y3_Y6_01, test='Chi')
#Model 3: Step-wise selection from Model 1 (BIC)
k = log(length(diversity_df[,1]))
diversity_Y3_Y6_03 <- step(diversity_Y3_Y6_01)
summary(diversity_Y3_Y6_03)
# Not sufficient evidence that Fenced is significant
summary(diversity_Y3_Y6_03)
# Model 3: Intercept + Treatment + Gap
summary(diversity_Y3_Y6_03)
# Estimated odds that diversity increased in a Gap Treatment quadrat (vs Control)
exp(-0.0102) # 0.42
# Model 3: Intercept + Treatment + Gap
summary(diversity_Y3_Y6_03)
# Estimated odds that diversity increased in a Radial Treatment quadrat (vs Control)
exp(1.2214) # 0.42
# Estimated 95% CI for these odds
c(exp(1.2214-1.96*0.3800), exp(1.2214+1.96*0.3800))
# Model 3: Intercept + Treatment + Gap
summary(diversity_Y3_Y6_03)
# Estimated odds that diversity in an In Gap quadrat will increase (vs Not In Gap)
exp(-0.6971)
# Estimated 95% CI for these odds
c(exp(-0.6971-1.96*0.3227), exp(-0.6971+1.96*0.3227))
# Estimated odds that diversity in an In Gap quadrat will increase (vs Not In Gap)
exp(-0.6971)
# Model the probability that diversity increased between years 0 and 6
diversity_df$Y3.Y6.Increase <- diversity_df$X6 > diversity_df$X0
# Model the probability that diversity increased between years 0 and 6
diversity_df$Y0.Y6.Increase <- diversity_df$X6 > diversity_df$X0
# Model the probability that diversity increased between years 0 and 6
diversity_df$Y0.Y6.Increase <- diversity_df$X6 > diversity_df$X0
diversity_df$Y0.Y6.Increase <- as.numeric(diversity_df$Y0.Y6.Increase)
# Model 1: Treatment, Fenced, Gap, and first-order interaction terms
diversity_Y0_Y6_01 <- glm(Y0.Y6.Increase ~ (Treatment + Fenced + Gap)^2,
family='binomial', data=diversity_df)
summary(diversity_Y0_Y6_01)
# Model 2: Step-wise selection from Model 1 (AIC)
diversity_Y0_Y6_02 <- step(diversity_Y0_Y6_01)
summary(diversity_Y0_Y6_02)
# Model 3: Step-wise selection from Model 1 (BIC)
k = log(length(diversity_df[,1]))
diversity_Y0_Y6_02 <- step(diversity_Y0_Y6_01, k=k)
# Model 2: Step-wise selection from Model 1 (AIC)
diversity_Y0_Y6_02 <- step(diversity_Y0_Y6_01)
summary(diversity_Y0_Y6_02)
# Model 3: Step-wise selection from Model 1 (BIC)
k = log(length(diversity_df[,1]))
summary(diversity_Y0_Y6_03)
diversity_Y0_Y6_03 <- step(diversity_Y0_Y6_01, k=k)
summary(diversity_Y0_Y6_03)
anova(diversity_Y0_Y6_03, diversity_Y0_Y6_02, test='Chi')
# Fenced, Gap, and Interaction remain in the model, but not significant
anova(diversity_Y0_Y6_02, diversity_Y0_Y6_01, test='Chi')
anova(diversity_Y0_Y6_03, diversity_Y0_Y6_02, test='Chi')
summary(diversity_Y0_Y6_03)
summary(diversity_Y0_Y6_02)
summary(diversity_Y0_Y6_02)
# Model 2: Intercept +
summary(diversity_Y0_Y6_02)
# Model 2: Intercept + Fenced + Gap + Intercept:Gap
summary(diversity_Y0_Y6_02)
# Estimated odds that diversity will increase in a quadrat that's In Gap, Not Fenced
# (vs Not In Gap, Not Fenced)
exp(-0.3437)
# Estimated 95% CI for this interval
c(exp(-0.3437-1.96*0.3120), exp(-0.3437-1.96*0.3120))
# Estimated 95% CI for this interval
c(exp(-0.3437-1.96*0.3120), exp(-0.3437+1.96*0.3120))
# Estimated odds that diversity will increase in a quadrat that's Fenced, Not In Gap
# (vs Not In Gap, Not Fenced)
exp(0.8884)
# Model 2: Intercept + Fenced + Gap + Intercept:Gap
summary(diversity_Y0_Y6_02)
# Estimated 95% CI for this interval
c(exp(0.8884-1.96*0.5146), exp(0.8884+1.96*0.5146))
# Estimated odds that diversity will increase in a quadrat that's Fenced, In Gap
# (vs Not In Gap, Not Fenced)
exp(0.8884-0.3437--0.9349) # 2.43
# Estimated odds that diversity will increase in a quadrat that's Fenced, In Gap
# (vs Not In Gap, Not Fenced)
exp(0.8884-0.3437-0.9349) # 2.43
