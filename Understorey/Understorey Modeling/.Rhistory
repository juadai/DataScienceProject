ylim=c(-1,22), ylab='Magnitude of change',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(abs(diversity_df$X3-diversity_df$X0)),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI  Y3 to Y6
plot(abs(diversity_df$X6-diversity_df$X3),
col=diversity_df$Col2, pch=16,
ylim=c(-1,22), ylab='Magnitude of change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(abs(diversity_df$X6-diversity_df$X3)),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Change in SDI Y0 to Y6 (quadrats)
plot(diversity_df$X6-diversity_df$X0,
col=diversity_df$Col3, pch=16,
ylim=c(-20,30), ylab='Change over time',
main="Change in diversity: Y0 to Y6")
lines(-25:300, rep(mean(diversity_df$X6-diversity_df$X0),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Change in SDI Y0 to Y3
plot(diversity_df$X3-diversity_df$X0,
col=diversity_df$Col3, pch=16,
ylim=c(-20,30), ylab='Change over time',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(diversity_df$X3-diversity_df$X0),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
# Change in SDI Y3 to Y6
plot(diversity_df$X6-diversity_df$X3,
col=diversity_df$Col3, pch=16,
ylim=c(-20,30), ylab='Change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(diversity_df$X6-diversity_df$X3),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI Y0 to Y6
plot(abs(diversity_df$X6-diversity_df$X0),
col=diversity_df$Col3, pch=16,
ylim=c(-1,22), ylab='Magnitude of change',
main="Change in diversity: Y0 to Y6")
lines(-25:300, rep(mean(abs(diversity_df$X6-diversity_df$X0)),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI  Y0 to Y3
plot(abs(diversity_df$X3-diversity_df$X0),
col=diversity_df$Col3, pch=16,
ylim=c(-1,22), ylab='Magnitude of change',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(abs(diversity_df$X3-diversity_df$X0)),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI Y3 to Y6
plot(abs(diversity_df$X6-diversity_df$X3),
col=diversity_df$Col3, pch=16,
ylim=c(-1,22), ylab='Magnitude of change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(abs(diversity_df$X6-diversity_df$X3)),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
line_plot <- function(df, label) {
n <- length(df$Treatment)
plot(0, type='l', xlim=c(0,6), ylim=c(-0.5,3.25),
xlab='Year', ylab="Shannon's Diversity Index",
main=paste(label, 'Plots'), col='white')
for (i in 1:n) {
lines(c(df[i,]$X0, df[i,]$X3, df[i,]$X6) ~ c(0,3,6),
col=df[i,]$Col1)
}
}
# All plots
line_plot(diversity_df_plot, 'All')
# Control plots
line_plot(diversity_df_plot[diversity_df_plot$Treatment=='Control',], 'Control')
# Gap plots
line_plot(diversity_df_plot[diversity_df_plot$Treatment=='Gap',], 'Gap')
# Radial plots
line_plot(diversity_df_plot[diversity_df_plot$Treatment=='Radial',], 'Radial')
# Change in SDI Y0 to Y6 (plots)
plot(diversity_df_plot$X6-diversity_df_plot$X0,
col=diversity_df_plot$Col, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in Shannon's DI: Y0 to Y6")
lines(-25:300, rep(mean(diversity_df_plot$X6-diversity_df_plot$X0),326),
col='red')
# Change in SDI Y0 to Y3 (plots)
plot(diversity_df_plot$X3-diversity_df_plot$X0,
col=diversity_df_plot$Col, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in Shannon's DI: Y0 to Y3")
# Change in SDI Y0 to Y6 (plots)
plot(diversity_df_plot$X6-diversity_df_plot$X0,
col=diversity_df_plot$Col1, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y0 to Y6")
lines(-25:300, rep(mean(diversity_df_plot$X6-diversity_df_plot$X0),326),
col='red')
legend('topleft', c('Control', 'Gap', 'Radial'), pch=16, bty='n',
col=cols1)
# Change in SDI Y0 to Y3 (plots)
plot(diversity_df_plot$X3-diversity_df_plot$X0,
col=diversity_df_plot$Col1, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(diversity_df_plot$X3-diversity_df_plot$X0),326),
col='red')
legend('topleft', c('Control', 'Gap', 'Radial'), pch=16, bty='n',
col=cols1)
# Change in SDI Y3 to Y6 (plots)
plot(diversity_df_plot$X6-diversity_df_plot$X3,
col=diversity_df_plot$Col1, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(diversity_df_plot$X6-diversity_df_plot$X3),326),
col='red')
legend('topleft', c('Control', 'Gap', 'Radial'), pch=16, bty='n',
col=cols1)
# Change in SDI Y0 to Y6 (quadrats)
plot(diversity_df$X6-diversity_df$X0,
col=diversity_df$Col1, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y0 to Y6")
lines(-25:300, rep(mean(diversity_df$X6-diversity_df$X0),326),
col='red')
legend('topleft', c('Control', 'Gap', 'Radial'), pch=16, bty='n',
col=cols1)
# Change in SDI Y0 to Y3
plot(diversity_df$X3-diversity_df$X0,
col=diversity_df$Col1, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(diversity_df$X3-diversity_df$X0),326),
col='red')
legend('topleft', c('Control', 'Gap', 'Radial'), pch=16, bty='n',
col=cols1)
# Change in SDI Y3 to Y6
plot(diversity_df$X6-diversity_df$X3,
col=diversity_df$Col1, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(diversity_df$X6-diversity_df$X3),326),
col='red')
legend('topleft', c('Control', 'Gap', 'Radial'), pch=16, bty='n',
col=cols1)
# Magnitude of change in SDI Y0 to Y6
plot(abs(diversity_df$X6-diversity_df$X0),
col=diversity_df$Col1, pch=16,
ylim=c(-0,3), ylab='Magnitude of change',
main="Change in diversity: Y0 to Y6")
lines(-25:300, rep(mean(abs(diversity_df$X6-diversity_df$X0)),326),
col='red')
legend('topleft', c('Control', 'Gap', 'Radial'), pch=16, bty='n',
col=cols1)
# Magnitude of change in SDI Y0 to Y3
plot(abs(diversity_df$X3-diversity_df$X0),
col=diversity_df$Col1, pch=16,
ylim=c(-0,3), ylab='Magnitude of change',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(abs(diversity_df$X3-diversity_df$X0)),326),
col='red')
legend('topleft', c('Control', 'Gap', 'Radial'), pch=16, bty='n',
col=cols1)
# Magnitude of change in SDI Y3 to Y6
plot(abs(diversity_df$X6-diversity_df$X3),
col=diversity_df$Col1, pch=16,
ylim=c(-0,3), ylab='Magnitude of change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(abs(diversity_df$X6-diversity_df$X3)),326),
col='red')
legend('topleft', c('Control', 'Gap', 'Radial'), pch=16, bty='n',
col=cols1)
# Change in SDI Y0 to Y6 (quadrats)
plot(diversity_df$X6-diversity_df$X0,
col=diversity_df$Col2, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y0 to Y6")
lines(-25:300, rep(mean(diversity_df$X6-diversity_df$X0),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Change in SDI Y0 to Y3
plot(diversity_df$X3-diversity_df$X0,
col=diversity_df$Col2, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(diversity_df$X3-diversity_df$X0),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Change in SDI Y3 to Y6
plot(diversity_df$X6-diversity_df$X3,
col=diversity_df$Col2, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(diversity_df$X6-diversity_df$X3),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI Y0 to Y6
plot(abs(diversity_df$X6-diversity_df$X0),
col=diversity_df$Col2, pch=16,
ylim=c(-0,3), ylab='Magnitude of change',
main="Change in diversity: Y0 to Y6")
lines(-25:300, rep(mean(abs(diversity_df$X6-diversity_df$X0)),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI  Y0 to Y3
plot(abs(diversity_df$X3-diversity_df$X0),
col=diversity_df$Col2, pch=16,
ylim=c(-0,3), ylab='Magnitude of change',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(abs(diversity_df$X3-diversity_df$X0)),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI  Y3 to Y6
plot(abs(diversity_df$X6-diversity_df$X3),
col=diversity_df$Col2, pch=16,
ylim=c(-0,3), ylab='Magnitude of change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(abs(diversity_df$X6-diversity_df$X3)),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Change in SDI Y0 to Y6 (quadrats)
plot(diversity_df$X6-diversity_df$X0,
col=diversity_df$Col3, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y0 to Y6")
lines(-25:300, rep(mean(diversity_df$X6-diversity_df$X0),326),
col='red')
legend('topleft', c('Unfenced', 'Fenced'), pch=16, bty='n',
col=cols2)
# Change in SDI Y0 to Y3
plot(diversity_df$X3-diversity_df$X0,
col=diversity_df$Col3, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(diversity_df$X3-diversity_df$X0),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
# Change in SDI Y3 to Y6
plot(diversity_df$X6-diversity_df$X3,
col=diversity_df$Col3, pch=16,
ylim=c(-3,3), ylab='Change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(diversity_df$X6-diversity_df$X3),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI Y0 to Y6
plot(abs(diversity_df$X6-diversity_df$X0),
col=diversity_df$Col3, pch=16,
ylim=c(-0,3), ylab='Magnitude of change',
main="Change in diversity: Y0 to Y6")
lines(-25:300, rep(mean(abs(diversity_df$X6-diversity_df$X0)),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI  Y0 to Y3
plot(abs(diversity_df$X3-diversity_df$X0),
col=diversity_df$Col3, pch=16,
ylim=c(-0,3), ylab='Magnitude of change',
main="Change in diversity: Y0 to Y3")
lines(-25:300, rep(mean(abs(diversity_df$X3-diversity_df$X0)),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
# Magnitude of change in SDI Y3 to Y6
plot(abs(diversity_df$X6-diversity_df$X3),
col=diversity_df$Col3, pch=16,
ylim=c(-0,3), ylab='Magnitude of change over time',
main="Change in diversity: Y3 to Y6")
lines(-25:300, rep(mean(abs(diversity_df$X6-diversity_df$X3)),326),
col='red')
legend('topleft', c('Not in Gap', 'In Gap'), pch=16, bty='n',
col=cols2)
# Load data
library(rstudioapi)
setwd(dirname(getActiveDocumentContext()$path))
# Load data
abundance_df <- read.csv('../dataset/tables/lf_abund_analysis.csv')
abundance_rel_df <- read.csv('../dataset/tables/lf_abund_rel_analysis.csv')
# Treatments, Plot numbers, Quadrat numbers, Life forms as factors
abundance_df$Treatment <- factor(abundance_df$Treatment)
abundance_df$Plot.Number <- factor(abundance_df$Plot.Number)
abundance_df$Quadrat.Number <- factor(abundance_df$Quadrat.Number)
abundance_df$Life.Form <- factor(abundance_df$Life.Form)
abundance_rel_df$Treatment <- factor(abundance_rel_df$Treatment)
abundance_rel_df$Plot.Number <- factor(abundance_rel_df$Plot.Number)
abundance_rel_df$Quadrat.Number <- factor(abundance_rel_df$Quadrat.Number)
abundance_rel_df$Life.Form <- factor(abundance_rel_df$Life.Form)
# Convert Fenced, Gap columns to boolean
abundance_df$Gap <- abundance_df$Gap=='True'
abundance_df$Fenced <- abundance_df$Fenced=='True'
abundance_rel_df$Gap <- abundance_rel_df$Gap=='True'
abundance_rel_df$Fenced <- abundance_rel_df$Fenced=='True'
# Relative Abundance: convert from proportion to percentage, and round to integer
# Note: Trace observations (below 1%) rounded up to 1%
abundance_rel_df$response <- abundance_rel_df$X0*100
abundance_rel_df[abundance_rel_df$response < 1 & abundance_rel_df$response != 0, 'response'] <- 1
abundance_rel_df$response <- round(abundance_rel_df$response)
# Weight for BIC
k <- log(length(abundance_rel_df$response))
plot(abundance_df$X0,
col=abundance_df$Life.Form)
plot(abundance_df$X0,
col=abundance_df$Life.Form,
pch='c')
plot(abundance_df$X0,
col=abundance_df$Life.Form,
pch='.')
plot(col=abundance_df$Life.Form)
plot(col=abundance_df$Life.Form)
plot(col=abundance_df$Life.Form~abundance_df$X0)
plot(abundance_df$X0~abundance_df$Life.Form)
plot(abundance_df$X0~abundance_df$Gap)
plot(abundance_df$X0~abundance_df$Fenced)
plot(abundance_df$X0~abundance_df$Treatment)
plot(abundance_df$X0~abundance_df$Treatment*abundance_df$Plot.Number)
plot(abundance_df$X0~abundance_df$Plot.Number)
plot(abundance_df$X0~abundance_df$Plot.Number)
plot(abundance_df$X0,
col=abundance_df$Life.Form,
pch='.')
plot(abundance_df$X0,
col=abundance_df$Treatment,
pch='.')
palette()
plot(abundance_df$X0,
col=abundance_df$Treatment,
pch='.')
palette("R4")
plot(abundance_df$X0,
col=abundance_df$Treatment,
pch='.')
plot(abundance_df$X0,
col=abundance_df$Life.Form,
pch='.')
plot(abundance_df$X0,
col=abundance_df$Life.Form,
pch=16)
?legend
plot(abundance_df$X0,
col=abundance_df$Life.Form,
pch=16)
legend('topright', abundance_df$Life.Form, pch=16)
legend('topright', abundance_df$Life.Form, pch=16)
legend('topright', legend=abundance_df$Life.Form, pch=16)
plot(abundance_df$X0,
col=abundance_df$Life.Form,
pch=16)
abundance_rel_df$Life.Form
unique(abundance_rel_df$Life.Form)
lf <- unique(abundance_rel_df$Life.Form)
n <- length(lf)
View(abundance_df)
for (i in 1:n) {
print(lf[i])
print(sum(abundance_df[abundance_df$Life.Form==lf[i], 'X0']))
}
print('\n')
for (i in 1:n) {
print(lf[i])
print(sum(abundance_df[abundance_df$Life.Form==lf[i], 'X0']))
print('\n')
)
for (i in 1:n) {
print(lf[i])
print(sum(abundance_df[abundance_df$Life.Form==lf[i], 'X0']))
print('\n')
}
for (i in 1:n) {
print(lf[i])
print(sum(abundance_df[abundance_df$Life.Form==lf[i], 'X0']))
}
lf_abund <- sum(abundance_df[abundance_df$Life.Form==lf, 'X0'])
lf_abund <- lapply(abundance_df[abundance_df$Life.Form==lf, 'X0'], sum)
lf_abund <- lapply(sum, abundance_df[abundance_df$Life.Form==lf, 'X0'])
lf_abund <- lapply(sum, abundance_df[abundance_df$Life.Form==lf, 'X0'])
lf_abund <- lapply(abundance_df[abundance_df$Life.Form==lf, 'X0'], sum)
View(lf_abund)
lf <- unique(abundance_df$Life.Form)
n <- length(lf)
abund = rep(0,n)
for (i in 1:n) {
lf[i] <- sum(abundance_df[abundance_df$Life.Form==lf[i], 'X0'])
}
lf <- unique(abundance_df$Life.Form)
n <- length(lf)
abund = rep(0,n)
abund[i] <- sum(abundance_df[abundance_df$Life.Form==lf[i], 'X0'])
for (i in 1:n) {
abund[i] <- sum(abundance_df[abundance_df$Life.Form==lf[i], 'X0'])
}
abund
names(abund) <- lf
abund
plot(abund)
abund
abund > 100
sum(abund > 100)/length(abund)
sum(abund > 50)/length(abund)
sum(abund > 10)/length(abund)
(abund > 10)
sum(abund > 10)
sum(abund > 10)
sum(abund > 10)
sum(abund > 50)
sum(abund > 100)
sum(abund>200)
sum(abund>150)
sum(abund>200)
sum(abund > 10)
sum(abund > 50)
sum(abund > 100)
sum(abund > 200)
rel_abund = rep(0,n)
for (i in 1:n) {
rel_abund[i] <- sum(abundance_rel_df[abundance_rel_df$Life.Form==lf[i], 'X0'])
}
names(rel_abund) <- lf
rel_abund
rel_abund*100
round(rel_abund*100,4)
sum(rel_abund > 10)
sum(rel_abund > 50)
sum(rel_abund > 5)
sum(rel_abund > 8)
sum(rel_abund > 10)
sum(abund > 100)
sum(rel_abund > 3)
sum(rel_abund > 3)
sum(rel_abund > 5)
sum(rel_abund > 2)
sum(rel_abund > 1.5)
sum(rel_abund > 1)
sum(rel_abund > 2)
sum(rel_abund > 2.5)
sum(rel_abund > 2.5)
plot(rel_abund)
plot(sort(rel_abund))
?sort
plot(sort(rel_abund), decreasing=TRUE)
sum(rel_abund > 2.5)
sum(rel_abund > 5)
sum(rel_abund > 8)
sum(rel_abund > 10)
sum(rel_abund > 1.5)
sum(rel_abund > 2.5)
sum(rel_abund > 1)
rel_abund <- rel_abund[rel_abund>1]
names(rel_abund)
abundance_rel_df[abundance_rel_df$Life.Form %in% names(rel_abund),]
abundance_rel_df
abundance_rel_df <- abundance_rel_df[abundance_rel_df$Life.Form %in% names(rel_abund),]
model1.1 <- glm(response ~ (Treatment + Fenced + Gap + Year)^3,
family='poisson', data=abundance_rel_df)
k=log(length(abundance_rel_df$response))
model2.1 <- step(model1.1, k=k)
summary(model2.1)
model1.1 <- glm(response ~ (Fenced + Gap + Year)^3,
family='poisson', data=abundance_rel_df)
k=log(length(abundance_rel_df$response))
model2.1 <- step(model1.1, k=k)
summary(model2.1)
model1.1 <- glm(response ~ (Fenced + Gap + Life.Form + Year)^3,
family='poisson', data=abundance_rel_df)
k=log(length(abundance_rel_df$response))
model1.1 <- glm(response ~ (Treatment + Fenced + Gap + Life.Form + Year)^3,
family='poisson', data=abundance_rel_df)
k=log(length(abundance_rel_df$response))
model2.1 <- step(model1.1, k=k)
summary(model2.1)
rel_abund <- rel_abund[rel_abund>5]
abundance_rel_df <- abundance_rel_df[abundance_rel_df$Life.Form %in% names(rel_abund),]
model1.1 <- glm(response ~ (Treatment + Fenced + Gap + Life.Form + Year)^3,
family='poisson', data=abundance_rel_df)
k=log(length(abundance_rel_df$response))
model2.1 <- step(model1.1, k=k)
summary(model2.1)
rel_abund <- rel_abund[rel_abund>10]
abundance_rel_df <- abundance_rel_df[abundance_rel_df$Life.Form %in% names(rel_abund),]
model1.1 <- glm(response ~ (Treatment + Fenced + Gap + Life.Form + Year)^3,
family='poisson', data=abundance_rel_df)
k=log(length(abundance_rel_df$response))
model2.1 <- step(model1.1, k=k)
summary(model2.1)
plot(sort(rel_abund, decreasing=TRUE))
plot(sort(abund, decreasing=TRUE))
sum(abund > 10)
sum(abund > 50)
sum(abund > 100)
sum(abund > 200)
rel_abund = rep(0,n)
for (i in 1:n) {
rel_abund[i] <- sum(abundance_rel_df[abundance_rel_df$Life.Form==lf[i], 'X0'])
}
names(rel_abund) <- lf
round(rel_abund*100,4)
plot(sort(rel_abund, decreasing=TRUE))
