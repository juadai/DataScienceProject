names.arg=tail(rownames(imp)[imp_gini$ix], 15),
horiz=T, main='15 most important variables: Gini',
cex.names=0.8)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp)[imp_gini$ix], 15),
horiz=T, main='15 most important variables: Gini',
cex.names=0.85)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp)[imp_gini$ix], 15),
horiz=T, main='Gini: 15 most important variables',
cex.names=0.85)
imp <-
?importance
imp <-
?importance
?importance
imp <- importance(rf)
View(imp)
imp <- importance(rf, type=1)
View(imp)
View(imp)
imp <- importance(rf, type=2)
View(imp)
imp <- importance(rf, type=3)
imp <- importance(rf, type=1)
imp <- importance(rf, type=1)
rf <- randomForest(G~., data=train, ntree=which.min(rf$err.rate[,1]), importance=T)
imp <- importance(rf, type=1)
View(imp)
imp <- importance(rf)
imp_t2 <- importance(rf, type=2)
G_train_path <- '/Users/nickjolly/Documents/2022:23/Unimelb/MV Stats (MAST90138)/04 Assignments/03/XGtrainRain.txt'
G_test_path <- '/Users/nickjolly/Documents/2022:23/Unimelb/MV Stats (MAST90138)/04 Assignments/03/XGtestRain.txt'
train <- read.table(G_train_path, sep=',', header=T)
test <- read.table(G_test_path, sep=',', header=T)
train_X <- train[,1:365]
train_G <- train[,366]
test_X <- test[,1:365]
test_G <- test[,366]
train$G <- factor(train$G)
test$G <- factor(test$G)
rf <- randomForest(G~., data=train, ntree=3000)
which.min(rf$err.rate[,1])
plot(rf$err.rate[,1], type='l')
rf <- randomForest(G~., data=train, ntree=which.min(rf$err.rate[,1]), importance=T)
imp_t1 <- importance(rf, type=1)
imp_mean_dec <- sort(imp_t1, index.return=T)
imp_t2 <- importance(rf, type=2)
imp_gini <- sort(imp_t2, index.return=T)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp_t1)[imp_gini$ix], 15),
horiz=T, main='Mean Decrease: 15 most important variables',
cex.names=0.85)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp_t2)[imp_gini$ix], 15),
horiz=T, main='Gini: 15 most important variables',
cex.names=0.85)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp_t2)[imp_gini$ix], 15),
horiz=T, main='Gini: 15 most important variables',
cex.names=0.75)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp_t1)[imp_gini$ix], 15),
horiz=T, main='Mean Decrease: 15 most important variables',
cex.names=0.75)
View(imp_t1)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp_t1)[imp_gini$ix], 15),
horiz=T, main='Mean Decrease Accuracy: \n15 most important variables',
cex.names=0.75)
View(imp_t2)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp_t2)[imp_gini$ix], 15),
horiz=T, main='Mean Decrease Gini: \n15 most important variables',
cex.names=0.75)
imp_t1 <- importance(rf, type=1)
imp_mean_dec <- sort(imp_t1, index.return=T)
imp_t2 <- importance(rf, type=2)
imp_gini <- sort(imp_t2, index.return=T)
barplot(tail(imp_mean_dec$x, 15),
names.arg=tail(rownames(imp_t1)[imp_mean_dec$ix], 15),
horiz=T, main='Mean Decrease Accuracy: \n15 most important variables',
cex.names=0.75)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp_t2)[imp_gini$ix], 15),
horiz=T, main='Mean Decrease Gini: \n15 most important variables',
cex.names=0.75)
barplot(tail(imp_gini$x, 15),
names.arg=tail(rownames(imp_t2)[imp_gini$ix], 15),
horiz=T, main='Mean Decrease Gini: \n15 most important variables',
cex.names=0.75)
par(mfrow=c(2,1))
library(rstudioapi)
library(pROC)
library(lme4)
library(lmerTest)
setwd(dirname(getActiveDocumentContext()$path))
richness_df <- read.csv('../dataset/excluding weeds/richness_quadrats.csv')
setwd(dirname(getActiveDocumentContext()$path))
richness_df <- read.csv('../dataset/excluding weeds/richness_quadrats.csv')
richness_df <- read.csv('../dataset/excluding weeds/richness_quadrat.csv')
View(richness_df)
# Treatments, Plot numbers, Quadrat numbers, Life forms as factors
richness_df$Treatment <- factor(richness_df$Treatment)
richness_df$Plot.Number <- factor(richness_df$Plot.Number)
richness_df$Quadrat.Number <- factor(richness_df$Quadrat.Number)
richness_df$Gap <- richness_df$Gap=='True'
richness_df$Fenced <- richness_df$Fenced=='True'
# Remove null rows
richness_df <- na.omit(richness_df)
richness_Y3_01 <- glm(X3 ~ (X0 + Treatment + Gap + Fenced)^2,
family='poisson', data=richness_df)
summary(richness_Y3_01)
richness_Y3_02 <- step(richness_Y3_01)
summary(richness_Y3_02)
setwd(dirname(getActiveDocumentContext()$path))
richness_df <- read.csv('../dataset/tables/species_richness_quadrats.csv')
# Treatments, Plot numbers, Quadrat numbers, Life forms as factors
richness_df$Treatment <- factor(richness_df$Treatment)
richness_df$Plot.Number <- factor(richness_df$Plot.Number)
richness_df$Quadrat.Number <- factor(richness_df$Quadrat.Number)
# Convert Fenced, Gap columns to boolean
richness_df$Gap <- richness_df$Gap=='True'
richness_df$Fenced <- richness_df$Fenced=='True'
richness_df_plot$Gap <- richness_df_plot$Gap=='True'
richness_df_plot$Fenced <- richness_df_plot$Fenced=='True'
# Remove null rows
richness_df <- na.omit(richness_df)
richness_df_plot <- na.omit(richness_df_plot)
richness_Y3_01 <- glm(X3 ~ (X0 + Treatment + Gap + Fenced)^2,
family='poisson', data=richness_df)
summary(richness_Y3_01)
richness_Y3_02 <- step(richness_Y3_01)
summary(richness_Y3_02)
pchisq(263.32, 260. lower=F)
pchisq(263.32, 260, lower=F)
richness_Y6_01 <- glm(X6 ~ (X0 + X3 + Treatment + Gap + Fenced)^2,
family='poisson', data=richness_df)
summary(richness_Y6_01)
richness_Y6_02 <- step(richness_Y6_01)
summary(richness_Y6_02)
pchisq(313.82, 255, lower=F)
model1 <- lmer(X ~ (Treatment + Fenced + Gap + Year + Year2)^2 +
(1|Plot.Number), data=richness)
richness_0 <- cbind(richness_df[1:5],richness_df[6])
richness_0['Year']=0
names(richness_0) <- c("Treatment", "Plot.Number", 'Quadrat.Number', "Fenced", "Gap", "X", 'Year')
richness_3 <- cbind(richness_df[1:5],richness_df[7])
richness_3['Year'] <- 3
names(richness_3) <- c("Treatment", "Plot.Number", 'Quadrat.Number', "Fenced", "Gap", "X", 'Year')
richness_6 <- cbind(richness_df[1:5],richness_df[8])
richness_6['Year'] <- 6
names(richness_6) <- c("Treatment", "Plot.Number", 'Quadrat.Number', "Fenced", "Gap", "X", 'Year')
richness <- rbind(richness_0, richness_3, richness_6)
richness$Year2 <- richness$Year^2
model1 <- lmer(X ~ (Treatment + Fenced + Gap + Year + Year2)^2 +
(1|Plot.Number), data=richness)
model2 <- get_model(step(model1))
summary(model2)
RSS <- sum((richness$X - fitted(model2, richness))^2)
TSS <- sum((richness$X - mean(richness$X))^2)
R2 <- 1-RSS/TSS
R2
library(rstudioapi)
library(pROC)
library(lme4)
library(merTools)
setwd(dirname(getActiveDocumentContext()$path))
diversity_df <- read.csv('../dataset/excluding weeds/diversity_quadrat.csv')
diversity_df$Treatment <- factor(diversity_df$Treatment)
diversity_df$Plot.Number <- factor(diversity_df$Plot.Number)
diversity_df$Quadrat.Number <- factor(diversity_df$Quadrat.Number)
View(diversity_df)
diversity_df$Plot <- factor(diversity_df$Plot)
diversity_df$Quadrat <- factor(diversity_df$Quadrat)
# Convert Fenced, Gap columns to boolean
diversity_df$Gap <- diversity_df$Gap=='True'
diversity_df$Fenced <- diversity_df$Fenced=='True'
diversity_df <- na.omit(diversity_df)
diversity_Y3_01 <- glm(X3 ~ (X0 + Treatment + Gap + Fenced)^2,
data=diversity_df)
summary(diversity_Y3_01)
diversity_Y3_02 <- step(diversity_Y3_01)
summary(diversity_Y3_02)
plot(diversity_Y3_02)
RSS <- sum((diversity_df$X3 - fitted(diversity_Y3_02, diversity_df))^2)
TSS <- sum((diversity_df$X3 - mean(diversity_df$X3))^2)
R2 <- 1-RSS/TSS
R2
diversity_Y6_01 <- glm(X6 ~ (X0 + X3 + Treatment + Gap + Fenced)^2,
data=diversity_df)
summary(diversity_Y6_01)
diversity_Y6_02 <- step(diversity_Y6_01)
summary(diversity_Y6_02)
plot(diversity_Y6_02)
RSS <- sum((diversity_df$X6 - fitted(diversity_Y6_02, diversity_df))^2)
TSS <- sum((diversity_df$X6 - mean(diversity_df$X6))^2)
R2 <- 1-RSS/TSS
R2
diversity_0 <- cbind(diversity_df[1:5],diversity_df[6])
diversity_0['Year']=0
names(diversity_0) <- c("Treatment", "Plot.Number", 'Quadrat.Number', "Fenced", "Gap", "X", 'Year')
diversity_3 <- cbind(diversity_df[1:5],diversity_df[7])
diversity_3['Year'] <- 3
names(diversity_3) <- c("Treatment", "Plot.Number", 'Quadrat.Number', "Fenced", "Gap", "X", 'Year')
diversity_6 <- cbind(diversity_df[1:5],diversity_df[8])
diversity_6['Year'] <- 6
names(diversity_6) <- c("Treatment", "Plot.Number", 'Quadrat.Number', "Fenced", "Gap", "X", 'Year')
diversity <- rbind(diversity_0, diversity_3, diversity_6)
diversity$Year2 <- diversity$Year^2
m1 <- lmer(X ~ (Treatment + Fenced + Gap + Year + Year2)^2 +
(1|Plot.Number), data=diversity)
m2 <- get_model(step(m1))
summary(m2)
RSS <- sum((diversity$X - fitted(m2, diversity))^2)
TSS <- sum((diversity$X - mean(diversity$X))^2)
R2 <- 1-RSS/TSS
R2
library(rstudioapi)
library(pROC)
library(lme4)
library(merTools)
library(lmerTest)
setwd(dirname(getActiveDocumentContext()$path))
abundance_df <- read.csv('../dataset/excluding weeds/lf_abund_quadrat.csv')
abundance_df <- read.csv('../dataset/excluding weeds/lf_abund_quadrat.csv')
# Total abundance for each quadrat
n = length(abundance_matrix[,1])
X0 <-rowSums(abundance_matrix[,abundance_matrix[1,] == 0])[3:n]
X3 <-rowSums(abundance_matrix[,abundance_matrix[1,] == 3])[3:n]
X6 <-rowSums(abundance_matrix[,abundance_matrix[1,] == 6])[3:n]
abundance_totals <- abundance_matrix[,1:5]
colnames(abundance_totals) <- abundance_totals[2,]
abundance_totals <- cbind(abundance_totals[3:n,], X0, X3, X6)
View(abundance_df)
?group_bu
?group_by
group_by(abundance_df)
group_by(sum, data=abundance_df)
library(dplyr)
group_by(sum, data=abundance_df)
group_by((sum, data=)abundance_df)
group_by(abundance_df)
grouped <- aggregate(abundance_df$Abundance,
by=list(abundance_df$Treatment, abundance_df$Plot,
abundance_df$Quadrat, abundance_df$Fenced,
abundance_df$Gap, abundance_df$Year),
FUN=sum)
View(grouped)
colnames(grouped) <- c('Treatment', 'Plot', 'Quadrat', 'Fenced', 'Gap', 'Year')
View(grouped)
colnames(grouped) <- c('Treatment', 'Plot', 'Quadrat', 'Fenced', 'Gap', 'Year',
'Abundance')
library(rstudioapi)
library(pROC)
library(lme4)
library(merTools)
library(lmerTest)
library(dplyr)
setwd(dirname(getActiveDocumentContext()$path))
unique(df['Life.Form'])
unique(abundance_df['Life.Form'])
df <- read.csv('../dataset/excluding weeds/lf_abund_quadrat.csv')
df$Plot.Number <- factor(df$Plot.Number)
df$Treatment <- factor(df$Treatment)
df$Fenced <- df$Fenced=="True"
df$Gap <- df$Gap=="True"
df$Plot <- factor(df$Plot)
setwd(dirname(getActiveDocumentContext()$path))
df <- read.csv('../dataset/excluding weeds/lf_abund_quadrat.csv')
df <- read.csv('../dataset/excluding weeds/lf_abund_quadrat.csv')
df$Plot <- factor(df$Plot)
df$Treatment <- factor(df$Treatment)
df$Fenced <- df$Fenced=="True"
df$Gap <- df$Gap=="True"
View(df)
# LF = Large Forb/herb
df_LF <- df[df$Life.Form=="Large Forb/Herb",]
View(df_LF)
View(df_LF)
abundance_df <- read.csv('../dataset/excluding weeds/understorey_cleaned.csv')
grouped <- aggregate(abundance_df$Abundance,
by=list(abundance_df$Treatment, abundance_df$Plot,
abundance_df$Quadrat, abundance_df$Fenced,
abundance_df$Gap, abundance_df$Year),
FUN=sum)
View(grouped)
abundance_df <- read.csv('../dataset/excluding weeds/understorey_cleaned.csv')
abundance_df <- read.csv('../dataset/excluding weeds/understorey_cleaned.csv')
View(abundance_df)
abundance_df[,-c('Shade.Tolerant')
]]
abundance_df[,-c('Shade.Tolerant')]
abundance_df[,-c(1,11)]
abundance_df[1,-c(1,6,11)]
abundance_df <- abundance_df[1,-c(1,6,11)]
# Drop score, record ID, Shade tolerant
abundance_df <- abundance_df[1,-c(1,6,11)]
library(rstudioapi)
library(lme4)
library(lmerTest)
setwd(dirname(getActiveDocumentContext()$path))
df <- read.csv('../dataset/tables/abundance_species_for_analysis.csv')
df <- read.csv('../dataset/tables/abundance_species_for_analysis.csv')
unique(df['Life.Form'])
colnames(df)
df$Plot.Number <- factor(df$Plot.Number)
df$Treatment <- factor(df$Treatment)
df$Fenced <- df$Fenced=="True"
df$Gap <- df$Gap=="True"
# LF = Large Forb/herb
df_LF <- df_prime[df_prime$Life.Form=="Large Forb/Herb",]
# LF = Large Forb/herb
df_LF <- df[df$Life.Form=="Large Forb/Herb",]
View(df_LF)
View(df)
df <- read.csv('../dataset/excluding weeds/understorey_cleaned.csv')
View(df)
df$Plot.Number <- factor(df$Plot.Number)
df$Plot <- factor(df$Plot)
df$Treatment <- factor(df$Treatment)
df$Fenced <- df$Fenced=="True"
df$Gap <- df$Gap=="True"
# LF = Large Forb/herb
df_LF <- df[df$Life.Form=="Large Forb/Herb",]
View(df_LF)
df = df[,-c(1,6,11)]
df$Plot <- factor(df$Plot)
df$Treatment <- factor(df$Treatment)
df$Fenced <- df$Fenced=="True"
df$Gap <- df$Gap=="True"
# LF = Large Forb/herb
df_LF <- df[df$Life.Form=="Large Forb/Herb",]
LF_m1 <- lmer(Abundance ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_LF)
View(df_LF)
df$Year2 <- df$Year^2
# LF = Large Forb/herb
df_LF <- df[df$Life.Form=="Large Forb/Herb",]
LF_m1 <- lmer(Abundance ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_LF)
LF_m2 <- get_model(step(LF_m1))
summary(LF_m2)
plot(LF_m2)
df$log_abund <- log(df$Abundance)
LF_m3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot.Number) + (1|Species.Name), data=df_LF)
# LF = Large Forb/herb
df_LF <- df[df$Life.Form=="Large Forb/Herb",]
LF_m3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot.Number) + (1|Species.Name), data=df_LF)
LF_m3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_LF)
LF_m4 <- get_model(step(LF_m3))
summary(LF_m4)
plot(LF_m4)
RSS <- sum((df_LF$log_X - fitted(LF_m4, df_LF))^2)
TSS <- sum((df_LF$log_X - mean(df_LF$log_X))^2)
R2 <- 1-RSS/TSS
R2
RSS <- sum((df_LF$log_abund - fitted(LF_m4, df_LF))^2)
TSS <- sum((df_LF$log_abund - mean(df_LF$log_X))^2)
RSS <- sum((df_LF$log_abund - fitted(LF_m4, df_LF))^2)
TSS <- sum((df_LF$log_abund - mean(df_LF$log_X))^2)
R2 <- 1-RSS/TSS
TSS <- sum((df_LF$log_abund - mean(df_LF$log_abund))^2)
R2 <- 1-RSS/TSS
R2
# LF = Large Forb/herb
df_LF <- df[df$Life.Form=="Large Forb/Herb",]
LF_m1 <- lmer(X ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot.Number) + (1|Species.Name), data=df_LF)
LF_m2 <- get_model(step(LF_m1))
summary(LF_m2)
LF_m3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_LF)
plot(LF_m2)
LF_m1 <- lmer(X ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot.Number) + (1|Species.Name), data=df_LF)
LF_m1 <- lmer(Abundance~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot.Number) + (1|Species.Name), data=df_LF)
LF_m1 <- lmer(Abundance~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_LF)
LF_m2 <- get_model(step(LF_m1))
summary(LF_m2)
plot(LF_m2)
RSS <- sum((df_LF$log_abund - fitted(LF_m2, df_LF))^2)
TSS <- sum((df_LF$log_abund - mean(df_LF$log_abund))^2)
R2 <- 1-RSS/TSS
R2
RSS <- sum((df_LF$Abundance - fitted(LF_m2, df_LF))^2)
TSS <- sum((df_LF$Abundance - mean(df_LF$Abundance))^2)
R2 <- 1-RSS/TSS
R2
RSS <- sum((df_LF$log_abund - fitted(LF_m4, df_LF))^2)
TSS <- sum((df_LF$log_abund - mean(df_LF$log_abund))^2)
R2 <- 1-RSS/TSS
R2
summary(LF_m4)
df_MTG <- df[df$Life.Form=="Medium Tufted grass/sedge",]
MTG_m1 <- lmer(Abundance~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_MTG)
MTG_m2 <- get_model(step(LF_m1))
summary(LF_m2)
plot(LF_m2)
summary(MTG_m2)
plot(MTG_m2)
plot(MTG_m2)
MTG_m2 <- get_model(step(MTG_m1))
summary(MTG_m2)
plot(MTG_m2)
RSS <- sum((df_MTG$Abundance - fitted(MTG_m2, df_MTG))^2)
TSS <- sum((df_MTG$Abundance - mean(df_MTG$Abundance))^2)
R2 <- 1-RSS/TSS
R2
MTG_m3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_MTG)
MTG_m3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_MTG)
MTG_m4 <- get_model(step(MTG_m3))
summary(MTG_m4)
RSS <- sum((df_LF$log_abund - fitted(LF_m4, df_LF))^2)
TSS <- sum((df_LF$log_abund - mean(df_LF$log_abund))^2)
R2 <- 1-RSS/TSS
R2
df_MTNG <- df[df$Life.Form=="Medium Non-tfted grass/sedge",]
df_MTNG <- df[df$Life.Form=="Medium Non-tufted grass/sedge",]
MTNG_m1 <- lmer(Abundance~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_MTNG)
MTNG_m2 <- get_model(step(MTNG_m1))
summary(MTG_m2)
plot(MTG_m2)
summary(MTNG_m2)
plot(MTNG_m2)
RSS <- sum((df_MTNG$Abundance - fitted(MTNG_m2, df_MTNG))^2)
TSS <- sum((df_MTNG$Abundance - mean(df_MTNG$Abundance))^2)
R2 <- 1-RSS/TSS
R2
df_MNTG <- df[df$Life.Form=="Medium Non-tufted grass/sedge",]
MNTG_m1 <- lmer(Abundance~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_MNTG)
MNTG_m2 <- get_model(step(MNTG_m1))
summary(MNTG_m2)
plot(MNTG_m2)
RSS <- sum((df_MNTG$Abundance - fitted(MNTG_m2, df_MNTG))^2)
TSS <- sum((df_MNTG$Abundance - mean(df_MNTG$Abundance))^2)
R2 <- 1-RSS/TSS
R2
MNTG_m3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=df_MNTG)
MNTG_m4 <- get_model(step(MNTG_m3))
summary(MNTG_m4)
plot(MNTG_m4)
RSS <- sum((df_MNTG$log_abund - fitted(MNTG_m4, df_MNTG))^2)
TSS <- sum((df_MNTG$log_abund - mean(df_MNTG$log_abund))^2)
R2 <- 1-RSS/TSS
R2
plot(MNTG_m4)
library(rstudioapi)
library(pROC)
library(lme4)
library(merTools)
library(lmerTest)
library(dplyr)
setwd(dirname(getActiveDocumentContext()$path))
abundance_df <- read.csv('../dataset/excluding weeds/lf_abund_quadrat.csv')
grouped <- aggregate(abundance_df$Abundance,
by=list(abundance_df$Treatment, abundance_df$Plot,
abundance_df$Quadrat, abundance_df$Fenced,
abundance_df$Gap, abundance_df$Year),
FUN=sum)
colnames(grouped) <- c('Treatment', 'Plot', 'Quadrat', 'Fenced', 'Gap', 'Year',
'Abundance')
grouped
grouped$Year2 <- grouped$Year^2
model1 <- lmer(Abundance~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot) + (1|Species.Name), data=grouped)
model1 <- lmer(Abundance~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot), data=grouped)
model2 <- get_model(step(model1))
summary(model2)
plot(model2)
RSS <- sum((grouped$Abundance - fitted(model2, grouped))^2)
TSS <- sum((grouped$Abundance - mean(grouped$Abundance))^2)
R2 <- 1-RSS/TSS
R2
grouped$log_abund <- log(grouped$Abundance)
model3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot), data=grouped)
model3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot), data=grouped)
model4 <- get_model(step(model3))
summary(model4)
plot(model4)
RSS <- sum((grouped$log_abund - fitted(model4, grouped))^2)
TSS <- sum((grouped$log_abund - mean(grouped$log_abund))^2)
R2 <- 1-RSS/TSS
R2
grouped$log_abund>0
grouped$log_abund>1
grouped <- grouped[grouped$log_abund>1]
grouped <- grouped[grouped$log_abund>1,]
grouped$log_abund>1
model3 <- lmer(log_abund ~ (Treatment + Year + Year2 + Gap + Fenced)^2 +
(1|Plot), data=grouped)
model4 <- get_model(step(model3))
summary(model4)
plot(model4)
RSS <- sum((grouped$log_abund - fitted(model4, grouped))^2)
TSS <- sum((grouped$log_abund - mean(grouped$log_abund))^2)
R2 <- 1-RSS/TSS
R2
